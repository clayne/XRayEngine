Универсальные 64-х битные компиляторы уровней

Оригинальные компиляторы разработаны: GSC Game world
Правки компиляторов и сборка: SkyLoader
Благодарности: Abramcumner, K.D.


Состав компиляторов:
* Компилятор геометрии [ТЧ, ЧН, ЗП]
* Компилятор травы [ТЧ, ЧН, ЗП]
* Компилятор АИ-сетки [ТЧ, ЧН, ЗП]
* Сборщик спавна [ТЧ, ЧН, ЗП]


Описание основных изменений:
* Поддержка x64
* Поддержка форматов уровней основных игр серии
* Все компиляторы объединены в одно приложение
* Интерфейс полностью переписан на WinForms
* Добавлено меню компилятора, в котором можно выбрать проект уровня, выставить определенные настройки и запустить компиляцию
* Добавлена система сохранения и загрузки настроек последних проектов
* Создаваемое количество потоков теперь не фиксировано, а зависит от количества ядер процессора
* Произведен переход на библиотеку DirectXTex на замену устаревшим FreeImage и nvDXT
* Убран просчет RGB и Sun компонентов освещения и оставлен только Hemi
* Проведена работа по распоточиванию некоторых фаз компиляции и распоточиванию кода сторонних библиотек
* Интегрирован Discord Rich Presence для возможности следить за статусом компиляции на удаленном ПК
* Добавлена возможность запустить выключение ПК после компиляции
* Реализован прогресс бар на панели задач для отображения состояния текущей фазы компиляции при свернутом приложении
* Добавлены ключи для ускоренной компиляции уровней в целях тестирования
* Добавлены экспериментальные ключи для отключения некоторых фаз компиляции и установки параметров в обход параметров СДК
* Добавлены основные изменения прошлых компиляторов
* Расширен вывод информации по некоторым ошибкам
* Множество различных исправлений и правок

Описание изменений версии 1.1:
* Изменено хранение загружаемых текстур, что уменьшило потребление памяти
* Добавлено автоматическое уменьшение размеров загружаемых текстур высокого разрешения до 1К, что тоже повлияло на уменьшение потребления памяти
* Уменьшен шанс появления черных треугольников при недостаточном значении Pixel per meter
* Добавлен ключ -noimpl для пропуска стадии LIGHT: Implicit
* Добавлен ключ -noresize для отключения уменьшения размеров загружаемых текстур высокого разрешения
* Исправлено возможное подвисание окна приложения
* Исправлено некорректное запекание освещения для некоторых террейнов 
* Исправлено отсутствие ключа ЗП формата при старте компиляции из меню
* Исправлена оригинальная ошибка распараллеливания на стадиях запекания освещения
* Исправлен вылет при отсутствии implicit текстур

Установка:
Распаковать архив в папку с СДК.

Для работы требуется установленный Microsoft Visual C++ 2017 Redistributable х64.
Внимание: в данном компиляторе по умолчанию отключено запекание статического света и статических теней солнца. Для включения запекания этих компонентов необходимо использовать соответствующий ключ, указанный в описании.


Основные ключи:
Для компиляции геометрии уровня:
start bin\compilers_sky_x64\xrCompiler.exe -geometry -f имя_уровня -version название_версии (shoc/cs/cop)
Для компиляции детейлов (травы):
start bin\compilers_sky_x64\xrCompiler.exe -details -f имя_уровня -version название_версии (shoc/cs/cop)
Для компиляции АИ-сетки:
start bin\compilers_sky_x64\xrCompiler.exe -aispawn -f имя_уровня -version название_версии (shoc/cs/cop)
Для сборки спавна:
start bin\compilers_sky_x64\xrCompiler.exe -aispawn -s имя_уровня1,имя_уровня2,имя_уровня3 -out all


Ключи для компиляции геометрии:
-skipthm – не прерывать компиляцию при отсутствующих текстурах и файлах thm
-removeinvalid – не прерывать компиляцию при найденных invalid faces и удалять их
-skipinvalid – не прерывать компиляцию при найденных invalid faces и пропускать их
-tex_rgba – не использовать сжатие для сохраняемых текстур
-tex_bc7 – использовать BC7 сжатие для сохраняемых текстур (формат поддерживается только на DX11)
-silent – автоматически закрыть приложение после завершения компиляции
-sleep – выключить компьютер после завершения компиляции
-nohemi – отключить запекание освещения. Значительно ускоряет компиляцию. Предназначен для тестирования геометрии
-underground – компилировать уровень как подземный. Ускоряет компиляцию
-static – запекать статическое освещение (не работает с ключом -nohemi)
-cform – экспортировать только коллизию уровня
-noise – отключить создание Progressive геометрии. Ускоряет компиляцию, но не создает упрощенную геометрию уровня и Multiple Usage объектов
-nosmg – не использовать группы сглаживания
-notess – не тесселировать геометрию
-noweld – отключить велдинг маленьких треугольников
-nomerge – отключить стадию Merging geometry
-nostrip – отключить оптимизацию и стрипификацию геометрии
-dx_opt – включить оптимизацию геометрии средствами D3DX optimizer вместо NvTriStrip
-gi – включить фазу Radiosity
-no_mt_mu – не запускать расчет освещения для Multiple Usage объектов параллельно основной компиляции
-high – более высокий приоритет для потоков
-saveobj_base – сохранить всю геометрию уровня в obj файлы (базовая развертка)
-saveobj_lmap – сохранить всю геометрию уровня в obj файлы (лайтмап развертка)
-saveobj_cform – сохранять всю коллизию уровня в obj файл
-qual_draft – установить качество сцены в Draft (не влияет на выставленные шейдеры)
-qual_high – установить качество сцены в High (не влияет на выставленные шейдеры)
-ppm число – установить качество лайтмапов вместо значения в СДК
-weld_dist число – установить Weld distance вместо значения в СДК
-hemi_bias число – установить смещение позиции луча при запекании хеми (по умолчанию: 0.1, в оригинале: 0.001)


Ключи для компиляции травы:
-skipthm – не прерывать компиляцию при отсутствующих текстурах и файлах thm
-silent – автоматически закрыть приложение после завершения компиляции
-sleep – выключить компьютер после завершения компиляции
-nohemi – отключить запекание освещения. Значительно ускоряет компиляцию
-static – запекать статическое освещение (не работает с ключом -nohemi)


Ключи для компиляции АИ-сетки:
-draft – не просчитывать укрытия для АИ-сетки. Значительно ускоряет компиляцию
-verify – проверить АИ-сетку на ошибки
-noverbose – не выводить информацию об одиночных нодах (при ключе -verify)
-skipthm – не прерывать компиляцию при отсутствующих текстурах и файлах thm
-silent – автоматически закрыть приложение после завершения компиляции
-sleep – выключить компьютер после завершения компиляции


Общие ключи для всех компиляторов:
-help – вызов справки со списком всех ключей запуска
-t число – установить количество потоков для многопоточных операций (не работает с ключом -tbb)
-fsltx имя_файла – использовать свой ltx вместо fsgame.ltx.
-log_name имя_файла – создать файл лога с данным именем. Полезно для компиляции локаций очередью
-discord – включить Discord Rich Presence с выводом имени уровня и статуса компиляции
-discord_s – включить Discord Rich Presence с выводом только статуса компиляции
-tbb – использовать TBB многопоточность (не рекомендуется)

Примеры батников:
Ускоренная компиляция уровня для тестирования геометрии без запеченного освещения:
start bin\compilers_sky_x64\xrCompiler.exe -geometry -f zaton -nohemi -noise
start bin\compilers_sky_x64\xrCompiler.exe -details -f zaton -nohemi
start bin\compilers_sky_x64\xrCompiler.exe -aispawn -f zaton -draft

Компиляция подземного уровня, полностью закрытого nosun геометрией:
start bin\compilers_sky_x64\xrCompiler.exe -geometry -f labx8 -underground

Компиляция только коллизии уровня:
start bin\compilers_sky_x64\xrCompiler.exe -geometry -f zaton -cform

Компиляция локаций очередью с последующим выключением ПК:
start /wait bin\compilers_sky_x64\xrCompiler.exe -geometry -f zaton -log_name zaton_geometry -silent
start /wait bin\compilers_sky_x64\xrCompiler.exe -details -f zaton -log_name zaton_detail -silent
start /wait bin\compilers_sky_x64\xrCompiler.exe -aispawn -f zaton -log_name zaton_aimap -silent
start /wait bin\compilers_sky_x64\xrCompiler.exe -geometry -f jupiter -log_name jupiter_geometry -silent
start /wait bin\compilers_sky_x64\xrCompiler.exe -details -f jupiter -log_name jupiter_detail -silent
start /wait bin\compilers_sky_x64\xrCompiler.exe -aispawn -f jupiter -log_name jupiter_aimap -silent -sleep
